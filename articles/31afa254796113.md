---
title: "[Android]Annotation 1.4.0ã§è¿½åŠ ã•ã‚ŒãŸã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦"
emoji: "ğŸ“˜"
type: "tech"
topics:
  - "android"
  - "jetpack"
  - "annotation"
published: true
published_at: "2022-06-18 13:18"
---

[AndroidX ã® Annotation 1.4.0](https://developer.android.com/jetpack/androidx/releases/annotation#version_140_3) ã§ä»¥ä¸‹ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

- `@ReturnThis`
- `@OpenForTesting`
- `@DeprecatedSinceApi`
- `@EmptySuper`


# `@ReturnThis`

ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚¯ãƒ©ã‚¹ã€ã‚‚ã—ãã¯ãƒ¡ã‚½ãƒƒãƒ‰ã«ä»˜ä¸ã—ã¦ä½¿ã„ã¾ã™ã€‚
ãƒ¡ã‚½ãƒƒãƒ‰ã®æˆ»ã‚Šå€¤ãŒè‡ªèº«ã®ã‚¯ãƒ©ã‚¹ã ã£ãŸå ´åˆã€ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ãŸæ™‚ã«è‡ªåˆ†è‡ªèº«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã™ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚
ï¼ˆãƒ“ãƒ«ãƒ€ãƒ¼ãªã©ã®ãŸã‚ã«ä½¿ã†ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ï¼‰

ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ãŒã‚ã£ãŸã¨ã—ã¾ã™ã€‚

```kotlin
@ReturnThis
open class Builder {
    open fun number(number: Int): Builder {
        return this
    }

    open fun text(text: String): Builder {
        return this
    }
}
```

ä¸Šè¨˜ã®ã‚¯ãƒ©ã‚¹ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ãŸã¨ã—ã¾ã™ã€‚

```kotlin
class MyClass : Builder() {
    override fun number(number: Int): Builder {
        return this // â—‹ : è‡ªåˆ†è‡ªèº«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã—ã¦ã„ã‚‹
    }

    override fun text(text: String): Builder {
        return MyClass() // Ã— : è‡ªåˆ†è‡ªèº«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã—ã¦ã„ãªã„
    }
}

```

ã“ã®å ´åˆã€`number` ãƒ¡ã‚½ãƒƒãƒ‰ã®æ–¹ã¯è‡ªåˆ†è‡ªèº«ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã—ã¦ã„ã‚‹ã®ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚
ã—ã‹ã—ã€`text` ãƒ¡ã‚½ãƒƒãƒ‰ã®æ–¹ã¯æ–°ã—ãä½œæˆã—ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã—ã¦ã„ã‚‹ãŸã‚è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ã«ç‰¹å®šã®ãƒ¡ã‚½ãƒƒãƒ‰ã«å¯¾ã—ã¦ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```kotlin
open class Builder {
    @ReturnThis
    open fun someMethod(arg: Int): Builder {
        return this
    }
}

class MyClass : Builder() {
    override fun someMethod(arg: Int): Builder {
        return this
    }
}
```

# `@OpenForTesting`

ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚¯ãƒ©ã‚¹ã€ãƒ¡ã‚½ãƒƒãƒ‰ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä»˜ä¸ã—ã¦ä½¿ã„ã¾ã™ã€‚
ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã®ã¿ç¶™æ‰¿ã‚‚ã—ãã¯ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã‚’ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚

ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ãŒã‚ã£ãŸã¨ã—ã¾ã™ã€‚

```kotlin
@OpenForTesting
open class SomeClass {
    open fun someMethod() {
    }
}
```

ä¸Šè¨˜ã®ã‚¯ãƒ©ã‚¹ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚³ãƒ¼ãƒ‰ã§ç¶™æ‰¿ã™ã‚‹ã¨è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```kotlin
// Ã— : SomeClass1 should only be subclassed from tests ã¨ã„ã†è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹
class MySomeClass1 : SomeClass()
```

ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§ç¶™æ‰¿ã™ã‚‹ã¨ã€è­¦å‘Šã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

```kotlin
// â—‹ : ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã¯ç¶™æ‰¿å¯èƒ½.
class MySomeClass2 : SomeClass() 
```

# `@DeprecatedSinceApi`

ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚¯ãƒ©ã‚¹ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãªã©ã«ä»˜ä¸ã—ã¦ä½¿ã„ã¾ã™ã€‚
ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯ API ãƒ¬ãƒ™ãƒ«ã®æŒ‡å®šãŒå¯èƒ½ã§ã‚ã‚Šã€Min SDK ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«æŒ‡å®šã•ã‚ŒãŸ API ãƒ¬ãƒ™ãƒ«ã‚ˆã‚Šå°ã•ã„å ´åˆã«ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»˜ä¸ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ãªã©ã‚’å‘¼ã³å‡ºã™ã¨è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ãƒãƒƒã‚¯ãƒãƒ¼ãƒˆã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã„ã¦ã€ç‰¹å®šã® API ãƒ¬ãƒ™ãƒ«ä»¥é™ã§ã¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã® API ãŒä½¿ãˆã‚‹ã‚ˆã†ãªå ´åˆã«ä½¿ãˆã¾ã™ã€‚

ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ã« `minSdk` ãŒ 24 ã§è¨­å®šã•ã‚Œã¦ã„ãŸã¨ã—ã¾ã™ã€‚

```groovy:build.gradle
android {
    defaultConfig {
        minSdk 24
    }
}
```

ãã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ãŒã‚ã£ãŸã¨ã—ã¾ã™ã€‚

```kotlin
class Api {
    @DeprecatedSinceApi(api = 21)
    fun someMethod1() {}

    @DeprecatedSinceApi(api = 25)
    fun someMethod2() {}

    @DeprecatedSinceApi(api = 30, message = "Use AlarmManager.notify instead")
    fun someMethod3() {}
}

@DeprecatedSinceApi(api = 28)
class Api2 {
    fun someMethod1() {}

    @DeprecatedSinceApi(api = 30)
    fun someMethod2() {}
}
```

ä¸Šè¨˜ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ãŸå ´åˆã€`Api#someMethod1` ä»¥å¤–ã¯è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```kotlin
fun test(api: Api, api2: Api2) {
    api.someMethod1() // OK
    api.someMethod2() // This method is deprecated as of API level 25 ã¨ã„ã†è­¦å‘ŠãŒå‡ºã‚‹.
    api.someMethod3() // This method is deprecated as of API level 30; Use AlarmManager.notify instead ã¨ã„ã†è­¦å‘ŠãŒå‡ºã‚‹.

    api2.someMethod1()  // This method is deprecated as of API level 28 ã¨ã„ã†è­¦å‘ŠãŒå‡ºã‚‹.
    api2.someMethod2()  // This method is deprecated as of API level 30 ã¨ã„ã†è­¦å‘ŠãŒå‡ºã‚‹.
}
```


# `@EmptySuper`

ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒ¡ã‚½ãƒƒãƒ‰ã«ä»˜ä¸ã—ã¦ä½¿ã„ã¾ã™ã€‚
ã“ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ç©ºã§ã‚ã‚‹ãŸã‚ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ãŸæ™‚ã«å‘¼ã¶å¿…è¦ãŒãªã„ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚

```kotlin
open class ParentClass {
    @EmptySuper
    open fun someMethod(arg: Int) {
        // ...
    }
}

class ChildClass : ParentClass() {
    override fun someMethod(arg: Int) {
        // Ã— : No need to call super.someMethod; the super method is defined to be empty ã¨ã„ã†è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹.
        super.someMethod(arg)
    }
}
```
